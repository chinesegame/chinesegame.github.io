import{Q as I}from"./QBtn.23675868.js";import{_ as N,y as f,z as d,C,ad as z,D as b,r as v,o as X,j as F,H as B,ae as G,F as R,ac as A,G as D,I as W,af as j,ag as P}from"./index.cdd86537.js";const Q={},H={class:"game-tile"},U={class:"game-tile__text"};function q(T,y){return f(),d("div",H,[C("div",U,[z(T.$slots,"default",{},void 0,!0)])])}var K=N(Q,[["render",q],["__scopeId","data-v-3b4bc040"]]);const Z={class:"game-area"},ee={class:"game-area__tiles"},te=b({__name:"GameArea",setup(T){const y=["#8EFF00","#741926","#00FFBB","#ED1313","#FCCE00"],$=["\u58EB","\u95E8","\u4EBA","\u5973","\u5B50"],r=v([]),x=l=>{for(let s=l.length-1;s>0;s--){let e=Math.floor(Math.random()*(s+1));[l[s],l[e]]=[l[e],l[s]]}};x(y);const _=$.map((l,s)=>({letter:l,color:y[s]})),k=()=>{const l=[];for(let e=0;e<36;e++)x(_),l.push({x:Math.floor(e%6),y:Math.floor(e/6),diffY:0,..._[0]});if(g(l).length||!E(l))return k();l.forEach(e=>({...e,preRemoved:!1})),r.value=l},h=v(null),n=v(null),c=v(null),u=v(null),m=v(""),p=v(""),J=(l,s)=>{l.touches?h.value={x:l.touches[0].clientX,y:l.touches[0].clientY}:h.value={x:l.x,y:l.y},u.value=l.target,n.value=s,m.value=u.value.style.left,p.value=u.value.style.top},O=l=>{let s={};l.touches?s={x:l.touches[0].clientX,y:l.touches[0].clientY}:s={x:l.x,y:l.y};const e={x:s.x-h.value.x,y:s.y-h.value.y};if(Math.abs(e.x)>Math.abs(e.y)){const t=e.x*100/window.innerWidth;Math.abs(t)<10.8&&(u.value.style.left=`calc(${m.value} + ${e.x*100/window.innerWidth}vw)`),u.value.style.top=p.value}else{const t=e.y*100/window.innerWidth;Math.abs(t)<10.8&&(u.value.style.top=`calc(${p.value} + ${e.y*100/window.innerWidth}vw)`),u.value.style.left=m.value}u.value.style.zIndex=1,u.value.style.transition="none"},L=()=>{if(!u.value||!n.value)return;u.value.style.transition="",u.value.style.zIndex=0;const l=parseFloat(u.value.style.left.split("(")[1]),s=parseFloat(u.value.style.top.split("(")[1]);let e=[];isNaN(l)||(l-parseFloat(m.value)>0?e=r.value.filter(a=>a.x===n.value.x+1&&a.y===n.value.y):e=r.value.filter(a=>a.x===n.value.x-1&&a.y===n.value.y)),isNaN(s)||(s-parseFloat(p.value)>0?e=r.value.filter(a=>a.x===n.value.x&&a.y===n.value.y+1):e=r.value.filter(a=>a.x===n.value.x&&a.y===n.value.y-1));const t=e.find(a=>!a.isRemoved),o={x:n.value.x,y:n.value.y};t?(c.value=t,n.value.y=c.value.y,n.value.x=c.value.x,c.value.x=o.x,c.value.y=o.y):(u.value.style.left=`${n.value.x*10.83+n.value.x*1.44}vw`,u.value.style.top=`${n.value.y*10.83+n.value.y*1.44}vw`),Y()};X(()=>{document.addEventListener("touchend",L),k()});const Y=()=>{const l=g(r.value);setTimeout(()=>{if(!l.length&&n.value&&c.value){const s={x:n.value.x,y:n.value.y};n.value.y=c.value.y,n.value.x=c.value.x,c.value.x=s.x,c.value.y=s.y;return}if(!l.length&&!E(r.value)){w();return}n.value=null,c.value=null,V(l)},300)};X(Y);const g=l=>{const s=[];for(let e=0;e<6;e++)s.push(l.filter(t=>t.y===e&&!t.isRemoved)),s.push(l.filter(t=>t.x===e&&!t.isRemoved));return s.forEach(e=>{let t=[];e.sort(function(o,a){return o.x>a.x&&o.y===a.y||o.y>a.y&&o.x===a.x?1:o.x<a.x&&o.y===a.y||o.y<a.y&&o.x===a.x?-1:0}),e.forEach(o=>{if(!t.length){t.push(o);return}const a=t[t.length-1];o.letter===a.letter&&(o.x-a.x===1||o.y-a.y===1)?t.push(o):t=[o],t.length>2&&t.forEach(i=>{i.preRemoved=!0})})}),l.filter(e=>e.preRemoved)},V=l=>{l.forEach(s=>{x(_);const e=S(s.x,-1),t={x:s.x,y:e,diffY:Math.abs(e)-1,..._[0]};r.value.push(t);const o=r.value.filter(a=>a.y<s.y&&a.x===s.x&&!a.isRemoved&&!a.preRemoved);o.length&&o.forEach(a=>{a.diffY+=1}),s.preRemoved=!1,s.isRemoved=!0}),setTimeout(()=>{const s=r.value.filter(e=>e.diffY);s.length&&(s.forEach(e=>{e.y=e.y+e.diffY,e.diffY=0}),Y())},100)},S=(l,s)=>r.value.find(t=>t.x===l&&t.y===s)?S(l,s-1):s,w=()=>{let l=JSON.parse(JSON.stringify(r.value.filter(t=>!t.isRemoved))),s=JSON.parse(JSON.stringify(r.value.filter(t=>!t.isRemoved)));x(l);for(let t=0;t<36;t++){const o=l[t];o.oldX=o.x,o.oldY=o.y,o.x=Math.floor(t%6),o.y=Math.floor(t/6)}if(s=s.map(t=>{const o=l.find(a=>a.oldX===t.x&&a.oldY===t.y);return{...t,x:o.x,y:o.y}}),g(s).length||!E(l))return w();r.value=r.value.map(t=>{const o=l.find(a=>a.oldX===t.x&&a.oldY===t.y);return{...t,x:o.x,y:o.y}})},E=l=>{const s=JSON.parse(JSON.stringify(l.filter(e=>!e.isRemoved)));for(let e=0;e<36;e++){const t=s[e];t.initX=t.x,t.initY=t.y;for(let o=0;o<4;o++){let a={x:0,y:0};switch(o){case 0:a.x=1,a.y=0;break;case 1:a.x=-1,a.y=0;break;case 2:a.x=0,a.y=1;break;case 3:a.x=0,a.y=-1;break}const i=s.find(M=>M.x===t.x+a.x&&M.y===t.y+a.y);if(i){if(i.initX=i.x,i.initY=i.y,i.x=t.initX,i.y=t.initY,t.x=i.initX,t.y=i.initY,g(s).length)return e=36,o=4,t;if(t.x=t.initX,t.y=t.initY,i.x=i.initX,i.y=i.initY,e===35)return null}}}};return(l,s)=>(f(),d(R,null,[F(I,{class:"shuffle-btn",onClick:w},{default:B(()=>[G(" \u043F\u0435\u0440\u0435\u043C\u0435\u0448\u0430\u0442\u044C ")]),_:1}),C("div",Z,[C("div",ee,[(f(!0),d(R,null,A(r.value,(e,t)=>(f(),d(R,{key:t+e.letter},[e.isRemoved?P("",!0):(f(),D(K,{key:0,style:j({left:`${e.x*10.83+e.x*1.44}vw`,top:`${e.y*10.83+e.y*1.44}vw`,color:e.color}),onTouchstart:o=>J(o,e),onTouchmove:O,"data-letter":e.letter,"data-x":e.x,"data-y":e.y},{default:B(()=>[G(W(e.letter),1)]),_:2},1032,["style","onTouchstart","data-letter","data-x","data-y"]))],64))),128))])])],64))}});var le=N(te,[["__scopeId","data-v-98639ece"]]);const ae={class:"game"},se=b({__name:"GamePage",setup(T){return(y,$)=>(f(),d("div",ae,[F(I,{class:"game__back",to:"/",flat:""}),F(le)]))}});var re=N(se,[["__scopeId","data-v-eaf49ec8"]]);export{re as default};
