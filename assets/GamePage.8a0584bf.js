import{Q as A}from"./QBtn.8dc2deb5.js";import{_ as w,y as d,z as f,C as R,ad as L,D as B,r as i,o as M,F as $,ac as z,G as D,H as S,ae as V,I as W,af as P,ag as j,j as C}from"./index.a6ca1d12.js";const Q={},X={class:"game-tile"},H={class:"game-tile__text"};function U(m,y){return d(),f("div",X,[R("div",H,[L(m.$slots,"default",{},void 0,!0)])])}var b=w(Q,[["render",U],["__scopeId","data-v-6f6dfcf6"]]);const q={class:"game-area__tiles"},J=B({__name:"GameArea",setup(m){const y=["#8EFF00","#741926","#00FFBB","#ED1313","#FCCE00"],E=["\u58EB","\u95E8","\u4EBA","\u5973","\u5B50"],r=i([]),g=t=>{for(let s=t.length-1;s>0;s--){let e=Math.floor(Math.random()*(s+1));[t[s],t[e]]=[t[e],t[s]]}};g(y);const _=E.map((t,s)=>({letter:t,color:y[s]}));for(let t=0;t<36;t++)g(_),r.value.push({x:Math.floor(t%6),y:Math.floor(t/6),diffY:0,..._[0]});const x=i(null),o=i(null),c=i(null),n=i(null),h=i(""),p=i(""),k=(t,s)=>{t.touches?x.value={x:t.touches[0].clientX,y:t.touches[0].clientY}:x.value={x:t.x,y:t.y},n.value=t.target,o.value=s,h.value=n.value.style.left,p.value=n.value.style.top},G=t=>{let s={};t.touches?s={x:t.touches[0].clientX,y:t.touches[0].clientY}:s={x:t.x,y:t.y};const e={x:s.x-x.value.x,y:s.y-x.value.y};if(Math.abs(e.x)>Math.abs(e.y)){const a=e.x*100/window.innerWidth;Math.abs(a)<10.8&&(n.value.style.left=`calc(${h.value} + ${e.x*100/window.innerWidth}vw)`),n.value.style.top=p.value}else{const a=e.y*100/window.innerWidth;Math.abs(a)<10.8&&(n.value.style.top=`calc(${p.value} + ${e.y*100/window.innerWidth}vw)`),n.value.style.left=h.value}n.value.style.zIndex=1,n.value.style.transition="none"},Y=i(0),N=()=>{if(!n.value)return;n.value.style.transition="",n.value.style.zIndex=0;const t=parseFloat(n.value.style.left.split("(")[1]),s=parseFloat(n.value.style.top.split("(")[1]);let e=[];isNaN(t)||(t-parseFloat(h.value)>0?e=r.value.filter(l=>l.x===o.value.x+1&&l.y===o.value.y):e=r.value.filter(l=>l.x===o.value.x-1&&l.y===o.value.y)),isNaN(s)||(s-parseFloat(p.value)>0?e=r.value.filter(l=>l.x===o.value.x&&l.y===o.value.y+1):e=r.value.filter(l=>l.x===o.value.x&&l.y===o.value.y-1));const a=e.find(l=>!l.isRemoved),u={x:o.value.x,y:o.value.y};a?(c.value=a,o.value.y=c.value.y,o.value.x=c.value.x,c.value.x=u.x,c.value.y=u.y):(n.value.style.left=`${o.value.x*10.83+o.value.x*1.44}vw`,n.value.style.top=`${o.value.y*10.83+o.value.y*1.44}vw`),T()};M(()=>{document.addEventListener("touchend",N)});const T=()=>{setTimeout(()=>{if(!I()&&o.value&&c.value){const s={x:o.value.x,y:o.value.y};o.value.y=c.value.y,o.value.x=c.value.x,c.value.x=s.x,c.value.y=s.y}o.value=null,c.value=null},500)};M(T);const I=()=>{const t=[];for(let e=0;e<6;e++)t.push(r.value.filter(a=>a.y===e&&!a.isRemoved)),t.push(r.value.filter(a=>a.x===e&&!a.isRemoved));t.forEach(e=>{let a=[];e.sort(function(u,l){return u.x>l.x&&u.y===l.y||u.y>l.y&&u.x===l.x?1:u.x<l.x&&u.y===l.y||u.y<l.y&&u.x===l.x?-1:0}),e.forEach(u=>{if(!a.length){a.push(u);return}const l=a[a.length-1];u.letter===l.letter&&(u.x-l.x===1||u.y-l.y===1)?a.push(u):a=[u],a.length>2&&a.forEach(v=>{v.preRemoved=!0})})});const s=r.value.filter(e=>e.preRemoved);return s.forEach(e=>{g(_);const a=F(e.x,-1),u={x:e.x,y:a,diffY:Math.abs(a)-1,..._[0]};r.value.push(u);const l=r.value.filter(v=>v.y<e.y&&v.x===e.x&&!v.isRemoved&&!v.preRemoved);l.length&&l.forEach(v=>{v.diffY+=1}),e.preRemoved=!1,e.isRemoved=!0}),setTimeout(()=>{const e=r.value.filter(a=>a.diffY);e.length&&(e.forEach(a=>{a.y=a.y+a.diffY,a.diffY=0}),T())},100),s.length},F=(t,s)=>r.value.find(a=>a.x===t&&a.y===s)?F(t,s-1):s;return(t,s)=>(d(),f("div",{key:Y.value,class:"game-area"},[R("div",q,[(d(!0),f($,null,z(r.value,(e,a)=>(d(),f($,{key:a+e.letter},[e.isRemoved?j("",!0):(d(),D(b,{key:0,style:P({left:`${e.x*10.83+e.x*1.44}vw`,top:`${e.y*10.83+e.y*1.44}vw`,color:e.color}),onTouchstart:u=>k(u,e),onTouchmove:G,"data-letter":e.letter,"data-x":e.x,"data-y":e.y},{default:S(()=>[V(W(e.letter),1)]),_:2},1032,["style","onTouchstart","data-letter","data-x","data-y"]))],64))),128))])]))}});var K=w(J,[["__scopeId","data-v-2c9f4d92"]]);const O={class:"game"},Z=B({__name:"GamePage",setup(m){return(y,E)=>(d(),f("div",O,[C(A,{class:"game__back",to:"/",flat:""}),C(K)]))}});var ae=w(Z,[["__scopeId","data-v-2bde8950"]]);export{ae as default};
