import{Q as b}from"./QBtn.3ea9eb81.js";import{_ as $,y as d,z as y,C as F,ad as A,D as J,r as c,o as B,j as N,H as G,ae as I,F as R,ac as D,G as W,I as j,af as P,ag as Q,ab as H}from"./index.038672a5.js";const U={},q={class:"game-tile"},K={class:"game-tile__text"};function Z(Y,x){return d(),y("div",q,[F("div",K,[A(Y.$slots,"default",{},void 0,!0)])])}var ee=$(U,[["render",Z],["__scopeId","data-v-3b4bc040"]]);const te={class:"game-area__tiles"},ae=J({__name:"GameArea",setup(Y){const x=["#8EFF00","#741926","#00FFBB","#ED1313","#FCCE00"],k=["\u58EB","\u95E8","\u4EBA","\u5973","\u5B50"],r=c([]),_=a=>{for(let s=a.length-1;s>0;s--){let e=Math.floor(Math.random()*(s+1));[a[s],a[e]]=[a[e],a[s]]}};_(x);const h=k.map((a,s)=>({letter:a,color:x[s]})),S=()=>{const a=[];for(let e=0;e<36;e++)_(h),a.push({x:Math.floor(e%6),y:Math.floor(e/6),diffY:0,...h[0]});if(T(a).length||!E(a))return S();a.forEach(e=>({...e,preRemoved:!1})),r.value=a},m=c(null),n=c(null),v=c(null),u=c(null),p=c(""),g=c(""),O=(a,s)=>{f.value||(a.touches?m.value={x:a.touches[0].clientX,y:a.touches[0].clientY}:m.value={x:a.x,y:a.y},u.value=a.target,n.value=s,p.value=u.value.style.left,g.value=u.value.style.top)},z=a=>{if(f.value)return;let s={};a.touches?s={x:a.touches[0].clientX,y:a.touches[0].clientY}:s={x:a.x,y:a.y};const e={x:s.x-m.value.x,y:s.y-m.value.y};if(Math.abs(e.x)>Math.abs(e.y)){const t=e.x*100/window.innerWidth;Math.abs(t)<10.8&&(u.value.style.left=`calc(${p.value} + ${e.x*100/window.innerWidth}vw)`),u.value.style.top=g.value}else{const t=e.y*100/window.innerWidth;Math.abs(t)<10.8&&(u.value.style.top=`calc(${g.value} + ${e.y*100/window.innerWidth}vw)`),u.value.style.left=p.value}u.value.style.zIndex=1,u.value.style.transition="none"},L=()=>{if(!u.value||!n.value||f.value)return;u.value.style.transition="",u.value.style.zIndex=0;const a=parseFloat(u.value.style.left.split("(")[1]),s=parseFloat(u.value.style.top.split("(")[1]);let e=[];isNaN(a)||(a-parseFloat(p.value)>0?e=r.value.filter(l=>l.x===n.value.x+1&&l.y===n.value.y):e=r.value.filter(l=>l.x===n.value.x-1&&l.y===n.value.y)),isNaN(s)||(s-parseFloat(g.value)>0?e=r.value.filter(l=>l.x===n.value.x&&l.y===n.value.y+1):e=r.value.filter(l=>l.x===n.value.x&&l.y===n.value.y-1));const t=e.find(l=>!l.isRemoved),o={x:n.value.x,y:n.value.y};t?(v.value=t,n.value.y=v.value.y,n.value.x=v.value.x,v.value.x=o.x,v.value.y=o.y):(u.value.style.left=`${n.value.x*10.83+n.value.x*1.44}vw`,u.value.style.top=`${n.value.y*10.83+n.value.y*1.44}vw`),w()};B(()=>{document.addEventListener("touchend",L),S()});const f=c(!1),w=()=>{f.value=!0;const a=T(r.value);setTimeout(()=>{if(setTimeout(()=>{f.value=!1},1e3),!a.length&&n.value&&v.value){const s={x:n.value.x,y:n.value.y};n.value.y=v.value.y,n.value.x=v.value.x,v.value.x=s.x,v.value.y=s.y;return}if(!a.length&&!E(r.value)){C();return}n.value=null,v.value=null,V(a)},300)};B(w);const T=a=>{const s=[];for(let e=0;e<6;e++)s.push(a.filter(t=>t.y===e&&!t.isRemoved)),s.push(a.filter(t=>t.x===e&&!t.isRemoved));return s.forEach(e=>{let t=[];e.sort(function(o,l){return o.x>l.x&&o.y===l.y||o.y>l.y&&o.x===l.x?1:o.x<l.x&&o.y===l.y||o.y<l.y&&o.x===l.x?-1:0}),e.forEach(o=>{if(!t.length){t.push(o);return}const l=t[t.length-1];o.letter===l.letter&&(o.x-l.x===1||o.y-l.y===1)?t.push(o):t=[o],t.length>2&&t.forEach(i=>{i.preRemoved=!0})})}),a.filter(e=>e.preRemoved)},V=a=>{a.forEach(s=>{_(h);const e=X(s.x,-1),t={x:s.x,y:e,diffY:Math.abs(e)-1,...h[0]};r.value.push(t);const o=r.value.filter(l=>l.y<s.y&&l.x===s.x&&!l.isRemoved&&!l.preRemoved);o.length&&o.forEach(l=>{l.diffY+=1}),s.preRemoved=!1,s.isRemoved=!0}),setTimeout(()=>{const s=r.value.filter(e=>e.diffY);s.length&&(s.forEach(e=>{e.y=e.y+e.diffY,e.diffY=0}),w())},100)},X=(a,s)=>r.value.find(t=>t.x===a&&t.y===s)?X(a,s-1):s,C=()=>{let a=JSON.parse(JSON.stringify(r.value.filter(t=>!t.isRemoved))),s=JSON.parse(JSON.stringify(r.value.filter(t=>!t.isRemoved)));_(a);for(let t=0;t<36;t++){const o=a[t];o.oldX=o.x,o.oldY=o.y,o.x=Math.floor(t%6),o.y=Math.floor(t/6)}if(s=s.map(t=>{const o=a.find(l=>l.oldX===t.x&&l.oldY===t.y);return{...t,x:o.x,y:o.y}}),T(s).length||!E(a))return C();r.value=r.value.map(t=>{const o=a.find(l=>l.oldX===t.x&&l.oldY===t.y);return{...t,x:o.x,y:o.y}})},E=a=>{const s=JSON.parse(JSON.stringify(a.filter(e=>!e.isRemoved)));for(let e=0;e<36;e++){const t=s[e];t.initX=t.x,t.initY=t.y;for(let o=0;o<4;o++){let l={x:0,y:0};switch(o){case 0:l.x=1,l.y=0;break;case 1:l.x=-1,l.y=0;break;case 2:l.x=0,l.y=1;break;case 3:l.x=0,l.y=-1;break}const i=s.find(M=>M.x===t.x+l.x&&M.y===t.y+l.y);if(i){if(i.initX=i.x,i.initY=i.y,i.x=t.initX,i.y=t.initY,t.x=i.initX,t.y=i.initY,T(s).length)return e=36,o=4,t;if(t.x=t.initX,t.y=t.initY,i.x=i.initX,i.y=i.initY,e===35)return null}}}};return(a,s)=>(d(),y(R,null,[N(b,{class:"shuffle-btn",onClick:C},{default:G(()=>[I(" \u043F\u0435\u0440\u0435\u043C\u0448\u0430\u0442\u044C ")]),_:1}),F("div",{class:H(["game-area",{animating:f.value}])},[F("div",te,[(d(!0),y(R,null,D(r.value,(e,t)=>(d(),y(R,{key:t+e.letter},[e.isRemoved?Q("",!0):(d(),W(ee,{key:0,style:P({left:`${e.x*10.83+e.x*1.44}vw`,top:`${e.y*10.83+e.y*1.44}vw`,color:e.color}),onTouchstart:o=>O(o,e),onTouchmove:z,"data-letter":e.letter,"data-x":e.x,"data-y":e.y},{default:G(()=>[I(j(e.letter),1)]),_:2},1032,["style","onTouchstart","data-letter","data-x","data-y"]))],64))),128))])],2)],64))}});var le=$(ae,[["__scopeId","data-v-63eddea4"]]);const se={class:"game"},oe=J({__name:"GamePage",setup(Y){return(x,k)=>(d(),y("div",se,[N(b,{class:"game__back",to:"/",flat:""}),N(le)]))}});var ue=$(oe,[["__scopeId","data-v-eaf49ec8"]]);export{ue as default};
