"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[383],{1618:(e,o,n)=>{n.d(o,{Z:()=>i});n(5363);var t=n(1768),a=n(2801),l=n(238);const s=({store:e,router:o,quasar:n,isLoading:s})=>{if(n.platform.is.cordova){const n=cordova.InAppBrowser.open(`${t.baseURL}/auth/google`,"_blank","location=yes");let i=!1;n.addEventListener("loadstart",(async t=>{if("https://happy-tourist.github.io/#/login/social"===t.url){i=!0,n.close();const t=await a.Z.auth.loginSocial();e.commit(l.F.SET_ACCESS_TOKEN,t.accessToken),o.go(0)}})),n.addEventListener("exit",(()=>{i||(s.value=!1)}))}else window.location.replace(`${t.baseURL}/auth/google`)},i=s},7383:(e,o,n)=>{n.r(o),n.d(o,{default:()=>F});var t=n(3673),a=n(2323),l=n(8880);const s={class:"text-h6"},i=(0,t.Uk)(" К урокам "),c={key:0},u=(0,t.Uk)(" Выйти "),d=(0,t._)("div",{class:"text-h6"}," войти через ",-1),r=(0,t.Uk)(" гугл "),g=(0,t.Uk)(" Что сделать с материалом, созданным в гостевом аккаунте? "),p={class:"q-gutter-lg q-pa-lg"};function h(e,o,n,h,m,v){const f=(0,t.up)("q-btn"),w=(0,t.up)("q-page"),S=(0,t.up)("q-card-section"),_=(0,t.up)("q-card"),y=(0,t.up)("q-dialog"),L=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.wy)((0,t.Wm)(w,{class:"column items-center q-col-gutter-lg"},{default:(0,t.w5)((()=>[(0,t._)("div",s," Привет, "+(0,a.zw)(e.user.name),1),(0,t._)("div",null,[(0,t.Wm)(f,{to:e.lessonsRoute},{default:(0,t.w5)((()=>[i])),_:1},8,["to"])]),e.user.socialId?((0,t.wg)(),(0,t.iD)("div",c,[(0,t.Wm)(f,{loading:e.isLoading,onClick:e.logout},{default:(0,t.w5)((()=>[u])),_:1},8,["loading","onClick"])])):((0,t.wg)(),(0,t.iD)(t.HY,{key:1},[d,(0,t._)("div",null,[(0,t.Wm)(f,{color:"primary",loading:e.isLoading,onClick:e.login},{default:(0,t.w5)((()=>[r])),_:1},8,["loading","onClick"])])],64))])),_:1},512),[[l.F8,e.isLoaded]]),(0,t.Wm)(y,{modelValue:e.showHasLessonsModal,"onUpdate:modelValue":o[2]||(o[2]=o=>e.showHasLessonsModal=o)},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{class:"column"},{default:(0,t.w5)((()=>[(0,t.Wm)(S,{class:"text-h6 q-pa-lg"},{default:(0,t.w5)((()=>[g])),_:1}),(0,t._)("div",p,[(0,t.wy)((0,t.Wm)(f,{label:"Отмена"},null,512),[[L]]),(0,t.wy)((0,t.Wm)(f,{label:"Перенести",color:"secondary",onClick:o[0]||(o[0]=o=>e.changeAction("replace"))},null,512),[[L]]),(0,t.wy)((0,t.Wm)(f,{label:"Удалить",color:"red",onClick:o[1]||(o[1]=o=>e.changeAction("delete"))},null,512),[[L]])])])),_:1})])),_:1},8,["modelValue"])],64)}var m=n(1959),v=n(3863),f=n(829),w=n(238),S=n(9253),_=n(9582),y=n(9232),L=n(6912),k=n(2801),C=n(1618),E=n(8825),Z=function(e,o,n,t){function a(e){return e instanceof n?e:new n((function(o){o(e)}))}return new(n||(n=Promise))((function(n,l){function s(e){try{c(t.next(e))}catch(o){l(o)}}function i(e){try{c(t["throw"](e))}catch(o){l(o)}}function c(e){e.done?n(e.value):a(e.value).then(s,i)}c((t=t.apply(e,o||[])).next())}))};const q=(0,t.aZ)({name:"PageIndex",props:{isLoaded:{type:Boolean,default:!1}},setup(){const e=(0,v.useStore)(),o=(0,_.tv)(),n=(0,E.Z)();e.dispatch(f.D.FETCH_USER);const a=(0,t.Fl)((()=>e.state.user)),l=(0,m.iH)(!1),s=(0,m.iH)(!1),{lessons:i}=e.state.lesson,c=t=>Z(this,void 0,void 0,(function*(){l.value=!0,yield k.Z.user.changeAction(t).catch((()=>{l.value=!1})),(0,C.Z)({store:e,router:o,quasar:n,isLoading:l})})),u=()=>Z(this,void 0,void 0,(function*(){l.value=!0,yield e.dispatch(f.D.LOGOUT_USER).finally((()=>{l.value=!1})),yield o.push({name:S.n.LOGIN}),e.commit(w.F.SET_ACCESS_TOKEN,""),e.commit(y.N.SET_LESSONS,[])})),d=()=>Z(this,void 0,void 0,(function*(){i.length||(yield e.dispatch(L.e.FETCH_LESSONS),e.state.lesson.lessons.length)?s.value=!0:(0,C.Z)({store:e,router:o,quasar:n,isLoading:l})})),r={name:S.n.LESSONS};return{user:a,logout:u,login:d,isLoading:l,lessonsRoute:r,showHasLessonsModal:s,changeAction:c}}});var b=n(4260),U=n(4379),W=n(2452),H=n(6818),T=n(151),O=n(5589),x=n(677),A=n(7518),N=n.n(A);const D=(0,b.Z)(q,[["render",h]]),F=D;N()(q,"components",{QPage:U.Z,QBtn:W.Z,QDialog:H.Z,QCard:T.Z,QCardSection:O.Z}),N()(q,"directives",{ClosePopup:x.Z})}}]);